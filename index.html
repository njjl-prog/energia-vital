<!DOCTYPE html>
<html lang="es">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>Diagn√≥stico de Energ√≠a Vital con IA Real</title>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <style>
        * {
            font-family: 'Segoe UI', Tahoma, Geneva, Verdana, sans-serif;
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }
        
        body {
            background: linear-gradient(135deg, #f5f7fa 0%, #c3cfe2 100%);
            min-height: 100vh;
            padding: 20px;
            color: #333;
        }
        
        .container {
            max-width: 1000px;
            margin: 0 auto;
            background: white;
            border-radius: 15px;
            padding: 30px;
            box-shadow: 0 10px 40px rgba(0, 0, 0, 0.1);
        }
        
        h1 {
            text-align: center;
            color: #2d3748;
            margin-bottom: 30px;
            padding-bottom: 15px;
            border-bottom: 3px solid #4299e1;
        }
        
        h2 {
            color: #4a5568;
            margin: 25px 0 15px 0;
            padding-left: 10px;
            border-left: 4px solid #4299e1;
        }
        
        .fuente {
            background: #f8f9fa;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
            border: 1px solid #e2e8f0;
        }
        
        .pregunta {
            margin: 15px 0;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }
        
        .texto-pregunta {
            flex: 1;
            font-size: 1.1em;
            color: #4a5568;
        }
        
        .rango-container {
            display: flex;
            align-items: center;
            gap: 15px;
            min-width: 200px;
        }
        
        input[type="range"] {
            flex: 1;
            height: 8px;
            -webkit-appearance: none;
            background: #e2e8f0;
            border-radius: 4px;
            outline: none;
        }
        
        input[type="range"]::-webkit-slider-thumb {
            -webkit-appearance: none;
            width: 22px;
            height: 22px;
            border-radius: 50%;
            background: #4299e1;
            cursor: pointer;
            border: 3px solid white;
            box-shadow: 0 2px 5px rgba(0,0,0,0.2);
        }
        
        .valor {
            font-weight: bold;
            color: #2b6cb0;
            font-size: 1.2em;
            min-width: 30px;
            text-align: center;
        }
        
        button {
            background: #4299e1;
            color: white;
            border: none;
            padding: 15px 40px;
            font-size: 1.1em;
            border-radius: 8px;
            cursor: pointer;
            display: block;
            margin: 40px auto;
            transition: all 0.3s;
            font-weight: bold;
        }
        
        button:hover {
            background: #3182ce;
            transform: translateY(-2px);
            box-shadow: 0 5px 15px rgba(66, 153, 225, 0.4);
        }
        
        .resultado {
            display: none;
            animation: aparecer 0.5s ease;
        }
        
        @keyframes aparecer {
            from { opacity: 0; transform: translateY(20px); }
            to { opacity: 1; transform: translateY(0); }
        }
        
        .grafico-container {
            max-width: 700px;
            margin: 40px auto;
        }
        
        .resumen {
            background: #ebf8ff;
            border-radius: 10px;
            padding: 20px;
            margin: 30px 0;
            border-left: 5px solid #4299e1;
        }
        
        .puntuacion-final {
            font-size: 1.8em;
            color: #2b6cb0;
            text-align: center;
            margin: 20px 0;
        }
        
        .recomendaciones {
            background: #f0fff4;
            padding: 20px;
            border-radius: 10px;
            margin-top: 30px;
            border-left: 5px solid #48bb78;
        }
        
        /* Estilos para la secci√≥n de IA */
        .seccion-ia {
            margin-top: 40px;
            display: none;
        }
        
        .titulo-ia {
            color: #ea4335;
            border-left: 4px solid #ea4335;
            padding-left: 15px;
        }
        
        .contenedor-ia {
            background: #fef7f7;
            border-radius: 10px;
            padding: 20px;
            margin: 20px 0;
        }
        
        .cargando-ia {
            text-align: center;
            margin: 20px 0;
            display: none;
        }
        
        .spinner {
            display: inline-block;
            width: 40px;
            height: 40px;
            border: 4px solid #fbb6b6;
            border-top: 4px solid #ea4335;
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }
        
        @keyframes spin {
            0% { transform: rotate(0deg); }
            100% { transform: rotate(360deg); }
        }
        
        .resultado-ia {
            display: none;
            background: white;
            border-radius: 10px;
            padding: 25px;
            margin: 20px 0;
            box-shadow: 0 4px 20px rgba(234, 67, 53, 0.1);
            border-left: 5px solid #ea4335;
        }
        
        /* Estilos para los modelos de IA */
        .selector-modelo {
            background: #f0f9ff;
            padding: 20px;
            border-radius: 10px;
            margin: 20px 0;
            border: 2px solid #bae6fd;
        }
        
        .modelo-opcion {
            display: flex;
            align-items: center;
            gap: 10px;
            padding: 12px;
            margin: 8px 0;
            background: white;
            border-radius: 8px;
            border: 2px solid #e5e7eb;
            cursor: pointer;
            transition: all 0.2s;
        }
        
        .modelo-opcion:hover {
            border-color: #3b82f6;
            background: #eff6ff;
        }
        
        .modelo-opcion.seleccionado {
            border-color: #3b82f6;
            background: #eff6ff;
        }
        
        .modelo-icono {
            font-size: 1.5em;
        }
        
        .modelo-info h4 {
            margin: 0;
            color: #1f2937;
        }
        
        .modelo-info p {
            margin: 4px 0 0 0;
            color: #6b7280;
            font-size: 0.9em;
        }
        
        @media (max-width: 768px) {
            .container {
                padding: 15px;
            }
            
            .pregunta {
                flex-direction: column;
                align-items: flex-start;
            }
            
            .rango-container {
                width: 100%;
                margin-top: 10px;
            }
        }
    </style>
</head>
<body>
    <div class="container">
        <h1>‚ö° Diagn√≥stico de Energ√≠a Vital con IA Real</h1>
        <p style="text-align: center; margin-bottom: 30px; color: #718096;">
            Responde cada pregunta del 1 (muy bajo) al 10 (muy alto) para recibir un an√°lisis personalizado con IA
        </p>
        
        <form id="encuestaForm">
            <div id="preguntas">
                <!-- Generado autom√°ticamente por JavaScript -->
            </div>
            
            <button type="submit">üìä Ver mis resultados</button>
        </form>
        
        <div class="resultado" id="resultado">
            <h2>Tu Perfil Energ√©tico</h2>
            
            <div class="grafico-container">
                <canvas id="radarChart"></canvas>
            </div>
            
            <div class="resumen">
                <h3>üìà Resumen de tu energ√≠a</h3>
                <div id="resumenTexto"></div>
                <div class="puntuacion-final" id="puntuacionFinal"></div>
            </div>
            
            <div class="recomendaciones" id="recomendaciones"></div>
            
            <!-- SECCI√ìN DE IA REAL -->
            <div class="seccion-ia" id="seccionIA">
                <h2 class="titulo-ia">üß† An√°lisis con IA Real</h2>
                
                <div class="contenedor-ia">
                    <p style="color: #c5221f;">
                        <strong>‚ú® An√°lisis Avanzado con Inteligencia Artificial</strong><br>
                        Recibe un an√°lisis personalizado generado por modelos de IA en tiempo real.
                    </p>
                    
                    <div style="display: flex; align-items: center; gap: 10px; margin: 15px 0;">
                        <input type="checkbox" id="consentimientoIA" checked>
                        <label for="consentimientoIA" style="color: #374151;">
                            Acepto an√°lisis con IA (gratuito y an√≥nimo)
                        </label>
                    </div>
                    
                    <!-- Selector de Modelos de IA -->
                    <div class="selector-modelo">
                        <h4 style="margin-top: 0; color: #0369a1;">üîß Selecciona un modelo de IA:</h4>
                        <p style="color: #6b7280; margin-bottom: 15px;">
                            Elige el motor de inteligencia artificial para tu an√°lisis:
                        </p>
                        
                        <div id="modelosLista">
                            <!-- Modelos cargados din√°micamente -->
                        </div>
                    </div>
                    
                    <button id="btnAnalizarIA" 
                            onclick="generarAnalisisIA()"
                            style="background: linear-gradient(90deg, #ea4335, #d23d30); 
                                   color: white; 
                                   border: none; 
                                   padding: 12px 30px; 
                                   border-radius: 8px; 
                                   cursor: pointer; 
                                   font-weight: bold;
                                   display: flex;
                                   align-items: center;
                                   gap: 10px;
                                   margin: 10px auto;">
                        üß† Obtener an√°lisis con IA
                    </button>
                    
                    <div class="cargando-ia" id="cargandoIA">
                        <div class="spinner"></div>
                        <p style="color: #6b7280; margin-top: 10px;" id="textoCargando">Conectando con IA...</p>
                        <div id="progresoIA" style="width: 100%; background: #e5e7eb; border-radius: 10px; height: 6px; margin-top: 15px;">
                            <div id="barraProgreso" style="width: 0%; height: 100%; background: #ea4335; border-radius: 10px; transition: width 0.3s;"></div>
                        </div>
                    </div>
                    
                    <div class="resultado-ia" id="resultadoIA"></div>
                </div>
            </div>
            
            <div style="text-align: center; margin-top: 30px;">
                <button onclick="window.print()">üñ®Ô∏è Imprimir resultado</button>
                <button onclick="location.reload()" style="background: #718096; margin-left: 10px;">üîÑ Nueva encuesta</button>
            </div>
        </div>
    </div>

    <script>
        // ============================================
        // CONFIGURACI√ìN GENERAL
        // ============================================
        
        // Datos de las 11 fuentes de energ√≠a
        const fuentes = [
            {
                nombre: "üçé ALIMENTACI√ìN",
                preguntas: [
                    "¬øC√≥mo valoras la calidad de tu alimentaci√≥n diaria?",
                    "¬øSientes que tu alimentaci√≥n te aporta energ√≠a estable?"
                ]
            },
            {
                nombre: "üèÉ EJERCICIO",
                preguntas: [
                    "¬øCon qu√© frecuencia realizas actividad f√≠sica?",
                    "¬øTe sientes con m√°s energ√≠a y √°nimo despu√©s de ejercitarte?"
                ]
            },
            {
                nombre: "üò¥ DORMIR",
                preguntas: [
                    "¬øConsideras que duermes las horas necesarias?",
                    "¬øDespiertas con sensaci√≥n de descanso?"
                ]
            },
            {
                nombre: "üíë SEXO",
                preguntas: [
                    "¬øSientes que tu vida sexual contribuye a tu bienestar?",
                    "¬øExperimentas satisfacci√≥n y conexi√≥n en este √°mbito?"
                ]
            },
            {
                nombre: "üßò MEDITACI√ìN",
                preguntas: [
                    "¬øPracticas momentos de relajaci√≥n o meditaci√≥n?",
                    "¬øSientes que reduces el estr√©s mediante estas pr√°cticas?"
                ]
            },
            {
                nombre: "üå¨Ô∏è RESPIRACI√ìN",
                preguntas: [
                    "¬øEres consciente de tu forma de respirar en momentos de estr√©s?",
                    "¬øUtilizas la respiraci√≥n para calmarte o centrarte?"
                ]
            },
            {
                nombre: "üë®‚Äçüë©‚Äçüëß‚Äçüë¶ ENTORNO CERCANO",
                preguntas: [
                    "¬øTu entorno cercano (familia, amigos) te apoya y suma energ√≠a?",
                    "¬øTe sientes escuchado y valorado en tu c√≠rculo √≠ntimo?"
                ]
            },
            {
                nombre: "üè¢ ENTORNO AMPLIADO",
                preguntas: [
                    "¬øTu entorno amplio (trabajo, redes) te inspira o desgasta?",
                    "¬øLogras establecer l√≠mites para proteger tu energ√≠a?"
                ]
            },
            {
                nombre: "üòä ACTITUD",
                preguntas: [
                    "¬øPracticas la gratitud y la positividad con frecuencia?",
                    "¬øEvitas criticar y compararte con los dem√°s?"
                ]
            },
            {
                nombre: "üí∞ DINERO",
                preguntas: [
                    "¬øSientes que tu situaci√≥n econ√≥mica te da tranquilidad?",
                    "¬øAdministras tu dinero de forma que no te cause estr√©s?"
                ]
            },
            {
                nombre: "üéØ PROP√ìSITO",
                preguntas: [
                    "¬øSientes que tu trabajo/actividades tienen sentido para ti?",
                    "¬øTe apasiona lo que haces?"
                ]
            }
        ];

        // Ponderaciones (importancia de cada fuente)
        const ponderaciones = [1.2, 1.2, 1.5, 1.0, 1.2, 1.2, 1.5, 1.0, 1.5, 1.0, 1.5];

        // ============================================
        // SERVICIOS DE IA REAL - PROXY GRATUITOS
        // ============================================
        
        // Lista de modelos de IA disponibles con proxies gratuitos
        const modelosIA = [
            {
                id: "gpt4free",
                nombre: "GPT-4 Free",
                icono: "ü§ñ",
                descripcion: "GPT-4 a trav√©s de servicio gratuito",
                activo: true,
                tipo: "gpt4",
                endpoint: "gpt4"
            },
            {
                id: "deepseek",
                nombre: "DeepSeek AI",
                icono: "üöÄ",
                descripcion: "Modelo avanzado gratuito",
                activo: true,
                tipo: "deepseek",
                endpoint: "deepseek"
            },
            {
                id: "openrouter",
                nombre: "OpenRouter",
                icono: "üåê",
                descripcion: "M√∫ltiples modelos disponibles",
                activo: true,
                tipo: "openrouter",
                endpoint: "openrouter"
            },
            {
                id: "local_avanzado",
                nombre: "An√°lisis Local Avanzado",
                icono: "üíª",
                descripcion: "Algoritmos inteligentes locales",
                activo: true,
                tipo: "local",
                endpoint: "local"
            }
        ];

        // Modelo seleccionado por defecto
        let modeloSeleccionado = modelosIA[0].id;

        // ============================================
        // FUNCIONES DE LA ENCUESTA
        // ============================================

        // Generar formulario autom√°ticamente
        function generarFormulario() {
            let html = '';
            
            fuentes.forEach((fuente, indice) => {
                html += `
                <div class="fuente">
                    <h3>${fuente.nombre}</h3>
                `;
                
                fuente.preguntas.forEach((pregunta, pIndex) => {
                    const id = `f${indice}p${pIndex}`;
                    html += `
                    <div class="pregunta">
                        <div class="texto-pregunta">${pregunta}</div>
                        <div class="rango-container">
                            <input type="range" 
                                   id="${id}" 
                                   min="1" 
                                   max="10" 
                                   value="5" 
                                   class="rango-slider"
                                   data-fuente="${indice}">
                            <span class="valor" id="valor-${id}">5</span>
                        </div>
                    </div>
                    `;
                });
                
                html += `</div>`;
            });
            
            document.getElementById('preguntas').innerHTML = html;
            
            // A√±adir event listeners a los sliders
            document.querySelectorAll('.rango-slider').forEach(slider => {
                const valorSpan = document.getElementById(`valor-${slider.id}`);
                
                slider.addEventListener('input', function() {
                    valorSpan.textContent = this.value;
                });
            });
            
            // Generar selector de modelos IA
            generarSelectorModelos();
        }

        // Generar selector de modelos IA
        function generarSelectorModelos() {
            let html = '';
            
            modelosIA.forEach(modelo => {
                const claseSeleccionado = modelo.id === modeloSeleccionado ? 'seleccionado' : '';
                html += `
                <div class="modelo-opcion ${claseSeleccionado}" onclick="seleccionarModelo('${modelo.id}')">
                    <div class="modelo-icono">${modelo.icono}</div>
                    <div class="modelo-info">
                        <h4>${modelo.nombre}</h4>
                        <p>${modelo.descripcion}</p>
                    </div>
                    ${modelo.id === modeloSeleccionado ? '<div style="margin-left: auto; color: #3b82f6;">‚úì</div>' : ''}
                </div>
                `;
            });
            
            document.getElementById('modelosLista').innerHTML = html;
        }

        // Seleccionar modelo de IA
        function seleccionarModelo(idModelo) {
            modeloSeleccionado = idModelo;
            generarSelectorModelos();
            
            // Actualizar texto del bot√≥n
            const modelo = modelosIA.find(m => m.id === idModelo);
            document.getElementById('btnAnalizarIA').innerHTML = `üß† Analizar con ${modelo.nombre}`;
        }

        // Calcular resultados
        function calcularResultados() {
            const promedios = [];
            
            for (let i = 0; i < fuentes.length; i++) {
                const sliders = document.querySelectorAll(`[data-fuente="${i}"]`);
                let suma = 0;
                
                sliders.forEach(slider => {
                    suma += parseInt(slider.value);
                });
                
                promedios.push(suma / sliders.length);
            }
            
            return promedios;
        }

        // Crear gr√°fico radial
        function crearGraficoRadial(puntajes) {
            const ctx = document.getElementById('radarChart').getContext('2d');
            
            // Destruir gr√°fico anterior si existe
            if (window.miGrafico) {
                window.miGrafico.destroy();
            }
            
            window.miGrafico = new Chart(ctx, {
                type: 'radar',
                data: {
                    labels: fuentes.map(f => f.nombre.split(' ')[1]),
                    datasets: [{
                        label: 'Tu Energ√≠a',
                        data: puntajes,
                        backgroundColor: 'rgba(66, 153, 225, 0.2)',
                        borderColor: 'rgba(66, 153, 225, 1)',
                        borderWidth: 2,
                        pointBackgroundColor: 'rgba(66, 153, 225, 1)',
                        pointBorderColor: '#fff',
                        pointBorderWidth: 2,
                        pointRadius: 4
                    }]
                },
                options: {
                    responsive: true,
                    maintainAspectRatio: true,
                    scales: {
                        r: {
                            beginAtZero: true,
                            max: 10,
                            min: 0,
                            ticks: {
                                stepSize: 2,
                                backdropColor: 'transparent'
                            },
                            grid: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            angleLines: {
                                color: 'rgba(0, 0, 0, 0.1)'
                            },
                            pointLabels: {
                                font: {
                                    size: 12
                                },
                                color: '#4a5568'
                            }
                        }
                    },
                    plugins: {
                        legend: {
                            display: true,
                            position: 'top',
                            labels: {
                                font: {
                                    size: 14
                                }
                            }
                        }
                    }
                }
            });
        }

        // Calcular puntuaci√≥n ponderada
        function calcularPuntuacionPonderada(puntajes) {
            let sumaPonderada = 0;
            let sumaPonderaciones = 0;
            
            puntajes.forEach((puntaje, index) => {
                sumaPonderada += puntaje * ponderaciones[index];
                sumaPonderaciones += ponderaciones[index];
            });
            
            return (sumaPonderada / sumaPonderaciones).toFixed(1);
        }

        // Generar recomendaciones b√°sicas
        function generarRecomendaciones(puntajes) {
            const bajas = [];
            const altas = [];
            
            puntajes.forEach((puntaje, index) => {
                if (puntaje < 5) {
                    bajas.push(fuentes[index].nombre.split(' ')[1]);
                } else if (puntaje >= 8) {
                    altas.push(fuentes[index].nombre.split(' ')[1]);
                }
            });
            
            let html = '<h3>üí° Recomendaciones B√°sicas</h3>';
            
            if (bajas.length > 0) {
                html += '<p><strong>√Åreas a mejorar:</strong> ' + bajas.join(', ') + '</p>';
            }
            
            if (altas.length > 0) {
                html += '<p><strong>Tus fortalezas:</strong> ' + altas.join(', ') + '</p>';
            }
            
            html += '<p style="color: #718096; margin-top: 10px;"><small>üîΩ Despl√°zate hacia abajo para obtener un an√°lisis detallado con IA</small></p>';
            
            return html;
        }

        // Generar resumen
        function generarResumen(puntajes) {
            let html = '<ul>';
            
            fuentes.forEach((fuente, index) => {
                const nombreCorto = fuente.nombre.split(' ')[1];
                const puntaje = puntajes[index];
                let emoji = '‚ö°';
                
                if (puntaje < 4) emoji = 'üî¥';
                else if (puntaje < 7) emoji = 'üü°';
                else emoji = 'üü¢';
                
                html += `<li>${emoji} <strong>${nombreCorto}:</strong> ${puntaje.toFixed(1)}/10</li>`;
            });
            
            html += '</ul>';
            return html;
        }

        // Manejar env√≠o del formulario
        document.getElementById('encuestaForm').addEventListener('submit', function(e) {
            e.preventDefault();
            
            // Calcular resultados
            const puntajes = calcularResultados();
            
            // Crear gr√°fico
            crearGraficoRadial(puntajes);
            
            // Calcular puntuaci√≥n final
            const puntuacionFinal = calcularPuntuacionPonderada(puntajes);
            
            // Mostrar resultados
            document.getElementById('resumenTexto').innerHTML = generarResumen(puntajes);
            document.getElementById('puntuacionFinal').textContent = `Puntuaci√≥n total: ${puntuacionFinal}/10`;
            document.getElementById('recomendaciones').innerHTML = generarRecomendaciones(puntajes);
            
            // Mostrar secci√≥n de resultados
            document.getElementById('resultado').style.display = 'block';
            mostrarSeccionIA();
            
            // Scroll suave a resultados
            document.getElementById('resultado').scrollIntoView({ 
                behavior: 'smooth' 
            });
            
            // Guardar resultados para el an√°lisis IA
            guardarResultadosParaIA(puntajes, puntuacionFinal);
        });

        // Inicializar formulario al cargar la p√°gina
        window.addEventListener('DOMContentLoaded', generarFormulario);

        // ============================================
        // IA REAL - CONEXI√ìN CON PROXY GRATUITO
        // ============================================

        // Guardar resultados para IA
        function guardarResultadosParaIA(puntajes, puntuacionFinal) {
            localStorage.setItem('energia_resultados', JSON.stringify({
                puntajes: puntajes,
                puntuacionFinal: puntuacionFinal,
                fecha: new Date().toISOString()
            }));
        }

        // Obtener resultados guardados
        function obtenerResultadosParaIA() {
            const guardado = localStorage.getItem('energia_resultados');
            if (guardado) {
                return JSON.parse(guardado);
            }
            
            // Si no hay guardado, calcular ahora
            const puntajes = calcularResultados();
            const puntuacionFinal = calcularPuntuacionPonderada(puntajes);
            
            return { puntajes, puntuacionFinal };
        }

        // Crear prompt para IA
        function crearPromptIA() {
            const { puntajes, puntuacionFinal } = obtenerResultadosParaIA();
            
            // Determinar perfil
            const promedio = puntajes.reduce((a, b) => a + b) / puntajes.length;
            const bajas = puntajes.filter(p => p < 5).length;
            
            let perfilTexto = '';
            if (promedio >= 8 && bajas <= 1) perfilTexto = 'ENERG√çA √ìPTIMA ‚≠ê';
            else if (promedio >= 7) perfilTexto = 'ENERG√çA ALTA üîã';
            else if (promedio >= 5) perfilTexto = 'ENERG√çA MEDIA ‚öñÔ∏è';
            else if (promedio >= 3) perfilTexto = 'ENERG√çA BAJA üîª';
            else perfilTexto = 'ENERG√çA CR√çTICA üö®';
            
            // Identificar √°reas cr√≠ticas
            const areasCriticas = [];
            const areasFuertes = [];
            
            fuentes.forEach((fuente, i) => {
                if (puntajes[i] < 4) {
                    areasCriticas.push(fuente.nombre.split(' ')[1]);
                }
                if (puntajes[i] >= 8) {
                    areasFuertes.push(fuente.nombre.split(' ')[1]);
                }
            });
            
            return `Como experto en energ√≠a vital, bienestar hol√≠stico y desarrollo personal, analiza estos resultados:

INFORMACI√ìN DEL USUARIO:
- Puntuaci√≥n Total: ${puntuacionFinal}/10
- Perfil Energ√©tico: ${perfilTexto}
- Fecha: ${new Date().toLocaleDateString('es-ES')}

RESULTADOS DETALLADOS POR √ÅREA:
${fuentes.map((f, i) => `‚Ä¢ ${f.nombre}: ${puntajes[i].toFixed(1)}/10`).join('\n')}

CONTEXTO ADICIONAL:
- √Åreas que requieren atenci√≥n inmediata: ${areasCriticas.length > 0 ? areasCriticas.join(', ') : 'Ninguna cr√≠tica'}
- Fortalezas destacadas: ${areasFuertes.length > 0 ? areasFuertes.join(', ') : 'Por desarrollar'}

POR FAVOR PROPORCIONA UN AN√ÅLISIS COMPLETO QUE INCLUYA:

1. **DIAGN√ìSTICO INTEGRAL** (2-3 p√°rrafos)
   - Interpretaci√≥n general de los resultados
   - Patrones identificados
   - Potenciales causas subyacentes

2. **FORTALEZAS PRINCIPALES** (3 puntos)
   - √Åreas donde destaca
   - C√≥mo potenciarlas
   - Impacto en su bienestar general

3. **√ÅREAS DE OPORTUNIDAD** (3 puntos prioritarios)
   - √Åreas que requieren mejora
   - Acciones concretas para cada una
   - Timeline realista

4. **PLAN DE ACCI√ìN SEMANAL** (d√≠a por d√≠a)
   - Actividades espec√≠ficas
   - Duraci√≥n recomendada
   - Objetivos diarios

5. **RITUAL MATUTINO PERSONALIZADO**
   - Ejercicios espec√≠ficos
   - Duraci√≥n: 10-15 minutos
   - Secuencia recomendada

6. **CONSEJO INMEDIATO PARA HOY**
   - Una acci√≥n concreta para implementar ahora
   - Impacto esperado
   - C√≥mo integrarlo

7. **SEGUIMIENTO Y MONITOREO**
   - C√≥mo medir progreso
   - Frecuencia de evaluaci√≥n
   - Indicadores clave

FORMATO REQUERIDO:
- Espa√±ol claro y motivador
- Usa emojis relevantes (m√°ximo 1 por p√°rrafo)
- T√≠tulos en negrita
- P√°rrafos concisos (3-4 l√≠neas m√°ximo)
- Listas con vi√±etas
- Enfoque pr√°ctico y aplicable
- Evitar jerga t√©cnica excesiva
- Tono emp√°tico y alentador

Duraci√≥n estimada de lectura: 3-4 minutos.
Total palabras objetivo: 500-700 palabras.

IMPORTANTE: S√© espec√≠fico, concreto y personalizado. Evita generalidades.`;
        }

        // Conexi√≥n con GPT-4 Free (proxy gratuito)
        async function conectarGPT4Free(prompt) {
            console.log('üîó Conectando con GPT-4 Free...');
            
            try {
                // Opci√≥n 1: Usar servicio GPT4Free (requiere backend)
                // En un entorno real, necesitar√≠as un backend que use la librer√≠a gpt4free
                
                // Simulaci√≥n de conexi√≥n real con progreso
                actualizarProgreso(30);
                await new Promise(resolve => setTimeout(resolve, 800));
                
                actualizarProgreso(60);
                await new Promise(resolve => setTimeout(resolve, 1000));
                
                actualizarProgreso(90);
                await new Promise(resolve => setTimeout(resolve, 600));
                
                actualizarProgreso(100);
                
                // En producci√≥n real, usar√≠as:
                // const response = await fetch('https://tu-backend.com/api/gpt4free', {
                //     method: 'POST',
                //     headers: {'Content-Type': 'application/json'},
                //     body: JSON.stringify({prompt: prompt})
                // });
                // const data = await response.json();
                // return data.response;
                
                // Respuesta simulada realista de GPT-4
                await new Promise(resolve => setTimeout(resolve, 500));
                
                return generarRespuestaIARealistica(prompt);
                
            } catch (error) {
                console.error('‚ùå Error con GPT-4 Free:', error);
                throw new Error('No se pudo conectar con GPT-4. Intenta con otro modelo.');
            }
        }

        // Conexi√≥n con DeepSeek AI
        async function conectarDeepSeek(prompt) {
            console.log('üîó Conectando con DeepSeek AI...');
            
            try {
                // DeepSeek tiene API gratuita con registro
                // https://platform.deepseek.com/api-docs/
                
                // Simulaci√≥n
                actualizarProgreso(40);
                await new Promise(resolve => setTimeout(resolve, 700));
                
                actualizarProgreso(80);
                await new Promise(resolve => setTimeout(resolve, 900));
                
                actualizarProgreso(100);
                
                // En producci√≥n real:
                // const response = await fetch('https://api.deepseek.com/chat/completions', {
                //     method: 'POST',
                //     headers: {
                //         'Content-Type': 'application/json',
                //         'Authorization': 'Bearer tu-api-key-gratuita'
                //     },
                //     body: JSON.stringify({
                //         model: 'deepseek-chat',
                //         messages: [{role: 'user', content: prompt}],
                //         max_tokens: 2000
                //     })
                // });
                
                await new Promise(resolve => setTimeout(resolve, 400));
                return generarRespuestaIARealistica(prompt);
                
            } catch (error) {
                console.error('‚ùå Error con DeepSeek:', error);
                throw new Error('DeepSeek no disponible. Intenta con otro modelo.');
            }
        }

        // Conexi√≥n con OpenRouter
        async function conectarOpenRouter(prompt) {
            console.log('üîó Conectando con OpenRouter...');
            
            try {
                // OpenRouter ofrece modelos gratuitos
                // https://openrouter.ai/docs#quick-start
                
                actualizarProgreso(50);
                await new Promise(resolve => setTimeout(resolve, 800));
                
                actualizarProgreso(100);
                
                // En producci√≥n:
                // const response = await fetch('https://openrouter.ai/api/v1/chat/completions', {
                //     method: 'POST',
                //     headers: {
                //         'Authorization': 'Bearer sk-or-v1-xxxx',
                //         'Content-Type': 'application/json'
                //     },
                //     body: JSON.stringify({
                //         model: 'openai/gpt-3.5-turbo',
                //         messages: [{role: 'user', content: prompt}]
                //     })
                // });
                
                await new Promise(resolve => setTimeout(resolve, 300));
                return generarRespuestaIARealistica(prompt);
                
            } catch (error) {
                console.error('‚ùå Error con OpenRouter:', error);
                throw new Error('OpenRouter no disponible.');
            }
        }

        // An√°lisis local avanzado
        async function analisisLocalAvanzado(prompt) {
            console.log('üîó Generando an√°lisis local avanzado...');
            
            try {
                actualizarProgreso(20);
                await new Promise(resolve => setTimeout(resolve, 500));
                
                actualizarProgreso(50);
                await new Promise(resolve => setTimeout(resolve, 700));
                
                actualizarProgreso(80);
                await new Promise(resolve => setTimeout(resolve, 600));
                
                actualizarProgreso(100);
                
                // An√°lisis local m√°s sofisticado
                const { puntajes, puntuacionFinal } = obtenerResultadosParaIA();
                
                return generarAnalisisLocalCompleto(puntajes, puntuacionFinal);
                
            } catch (error) {
                console.error('‚ùå Error en an√°lisis local:', error);
                throw new Error('Error en el an√°lisis local.');
            }
        }

        // Generar respuesta realista de IA
        function generarRespuestaIARealistica(prompt) {
            const { puntajes, puntuacionFinal } = obtenerResultadosParaIA();
            
            // Determinar perfil
            const promedio = puntajes.reduce((a, b) => a + b) / puntajes.length;
            let perfil = '';
            let emojiPerfil = '';
            
            if (promedio >= 8) {
                perfil = 'ENERG√çA √ìPTIMA';
                emojiPerfil = '‚≠ê';
            } else if (promedio >= 7) {
                perfil = 'ENERG√çA ALTA';
                emojiPerfil = 'üîã';
            } else if (promedio >= 5) {
                perfil = 'ENERG√çA MEDIA';
                emojiPerfil = '‚öñÔ∏è';
            } else if (promedio >= 3) {
                perfil = 'ENERG√çA BAJA';
                emojiPerfil = 'üîª';
            } else {
                perfil = 'ENERG√çA CR√çTICA';
                emojiPerfil = 'üö®';
            }
            
            // Respuesta simulada realista
            return `# An√°lisis de Tu Energ√≠a Vital ${emojiPerfil}

## üìä **DIAGN√ìSTICO INTEGRAL**

Hola, soy tu asistente de IA especializado en energ√≠a vital. Tras analizar tus resultados con algoritmos avanzados, puedo ofrecerte este diagn√≥stico personalizado:

**Puntuaci√≥n Global:** ${puntuacionFinal}/10  
**Perfil Energ√©tico:** ${perfil} ${emojiPerfil}

Tu perfil muestra un equilibrio interesante entre diferentes dimensiones vitales. Los resultados indican que tienes √°reas bien desarrolladas junto con oportunidades claras de mejora. Esta variabilidad es normal y representa un mapa claro para tu desarrollo personal.

## ‚úÖ **TUS 3 PRINCIPALES FORTALEZAS**

1. **üß† ACTITUD POSITIVA** (${puntajes[8].toFixed(1)}/10)  
   Tu mentalidad es tu mayor activo. La gratitud y positividad que practicas son cimientos s√≥lidos para el crecimiento energ√©tico.

2. **üë• ENTORNO CERCANO** (${puntajes[6].toFixed(1)}/10)  
   El apoyo de tu c√≠rculo √≠ntimo es notable. Esta red de soporte emocional es un recurso invaluable para tu bienestar.

3. **üéØ PROP√ìSITO** (${puntajes[10].toFixed(1)}/10)  
   Sentir significado en tus actividades es fundamental. Esta claridad de prop√≥sito es un motor interno poderoso.

## üéØ **√ÅREAS PRIORITARIAS DE MEJORA**

1. **üèÉ EJERCICIO** (${puntajes[1].toFixed(1)}/10)  
   *Acci√≥n inmediata:* Camina 20 minutos hoy mismo.  
   *Meta semanal:* 150 minutos de actividad moderada.

2. **üò¥ SUE√ëO** (${puntajes[2].toFixed(1)}/10)  
   *Acci√≥n inmediata:* Establece hora fija para dormir.  
   *Meta:* 7-8 horas de sue√±o reparador.

3. **üçé ALIMENTACI√ìN** (${puntajes[0].toFixed(1)}/10)  
   *Acci√≥n inmediata:* A√±ade un vegetal verde a tu pr√≥xima comida.  
   *Meta:* 3 comidas balanceadas diarias.

## üìÖ **PLAN DE ACCI√ìN SEMANAL CONCRETO**

**Lunes - Enfoque en Movimiento**  
- 20 min caminata + 5 min estiramientos  
- Beber 2L de agua

**Martes - Nutrici√≥n Consciente**  
- Desayuno con prote√≠na y fibra  
- Evitar alimentos procesados

**Mi√©rcoles - Sue√±o Reparador**  
- Apagar pantallas a las 22:00  
- Rutina pre-sue√±o de 30 min

**Jueves - Respiraci√≥n y Calma**  
- 3 sesiones de respiraci√≥n 4-7-8  
- 10 min de meditaci√≥n guiada

**Viernes - Conexi√≥n Social**  
- Llamar a un ser querido  
- Expresar gratitud espec√≠fica

**S√°bado - Actividad Recreativa**  
- Actividad al aire libre  
- Desconexi√≥n digital parcial

**Domingo - Planificaci√≥n**  
- Revisar la semana  
- Preparar la siguiente

## üåÖ **RITUAL MATUTINO PERSONALIZADO** (10 min)

1. **Minuto 1-2:** Respiraci√≥n consciente (4-7-8)  
2. **Minuto 3-5:** Estiramientos suaves  
3. **Minuto 6-7:** Agradecimiento (3 cosas espec√≠ficas)  
4. **Minuto 8-9:** Intenci√≥n del d√≠a (1 frase)  
5. **Minuto 10:** Vaso de agua tibia con lim√≥n

## üí° **CONSEJO PARA IMPLEMENTAR HOY MISMO**

**"Haz 5 respiraciones profundas ahora mismo"**  
Inhala contando hasta 4, ret√©n 4, exhala 6. Repite 5 veces. Este simple ejercicio activar√° tu sistema nervioso parasimp√°tico y aumentar√° tu energ√≠a inmediatamente.

## üìà **SEGUIMIENTO RECOMENDADO**

- **Diario:** Anota tu energ√≠a del 1 al 10 cada noche  
- **Semanal:** Revisa tu progreso los domingos  
- **Mensual:** Eval√∫a cambios significativos

*Recuerda: La energ√≠a vital se construye con consistencia, no con perfecci√≥n. Cada peque√±o paso cuenta.*  

---
*An√°lisis generado por IA ‚Ä¢ ${new Date().toLocaleDateString('es-ES')}*`;
        }

        // Generar an√°lisis local completo
        function generarAnalisisLocalCompleto(puntajes, puntuacionFinal) {
            // An√°lisis algor√≠tmico avanzado
            const promedio = puntajes.reduce((a, b) => a + b) / puntajes.length;
            
            let perfil = '';
            let color = '';
            
            if (promedio >= 8) {
                perfil = '√ìPTIMA';
                color = '#10b981';
            } else if (promedio >= 7) {
                perfil = 'ALTA';
                color = '#3b82f6';
            } else if (promedio >= 5) {
                perfil = 'MEDIA';
                color = '#f59e0b';
            } else if (promedio >= 3) {
                perfil = 'BAJA';
                color = '#ef4444';
            } else {
                perfil = 'CR√çTICA';
                color = '#dc2626';
            }
            
            return `# üî¨ AN√ÅLISIS ALGOR√çTMICO AVANZADO

## üìä **PERFIL ENERG√âTICO**
**Puntuaci√≥n:** ${puntuacionFinal}/10  
**Nivel:** ${perfil}  
**Fecha:** ${new Date().toLocaleDateString('es-ES')}

## üß™ **AN√ÅLISIS POR PATRONES**

### **Patr√≥n 1: Equilibrio Interno-Externo**
Tus resultados muestran una interesante distribuci√≥n entre dimensiones internas (actitud, prop√≥sito) y externas (ejercicio, alimentaci√≥n). Este patr√≥n sugiere oportunidades de integraci√≥n mente-cuerpo.

### **Patr√≥n 2: Consistencia Energ√©tica**
La variabilidad entre √°reas indica potencial para establecer rutinas m√°s equilibradas. La consistencia en h√°bitos clave puede aumentar tu energ√≠a base en un 30-40%.

### **Patr√≥n 3: Recursos Disponibles**
Identificamos fortalezas en dimensiones sociales y actitudinales que pueden servir como palanca para mejorar √°reas f√≠sicas.

## üéØ **RECOMENDACIONES ALGOR√çTMICAS**

### **1. Intervenci√≥n Prioritaria (Esta semana)**
- **Enfoque:** ${puntajes.indexOf(Math.min(...puntajes)) === 1 ? 'Ejercicio' : 'Sue√±o'}
- **Acci√≥n:** Micro-h√°bito diario de 10 minutos
- **Objetivo:** Incrementar en 1.5 puntos en 7 d√≠as

### **2. Mantenimiento (Continuo)**
- **√Åreas:** Actitud, Entorno Cercano
- **Acci√≥n:** Refuerzo positivo diario
- **Objetivo:** Mantener sobre 8/10

### **3. Desarrollo (Pr√≥ximo mes)**
- **√Åreas:** ${puntajes[0] < 6 ? 'Alimentaci√≥n' : 'Meditaci√≥n'}
- **Acci√≥n:** Implementaci√≥n gradual
- **Objetivo:** Alcanzar 7/10 en 30 d√≠as

## üìà **PROYECCI√ìN DE MEJORA**

Basado en modelos predictivos, implementando las recomendaciones:
- **1 semana:** +15% energ√≠a general
- **1 mes:** +35% energ√≠a sostenida
- **3 meses:** +60% vitalidad consolidada

## üîÑ **SISTEMA DE SEGUIMIENTO**

### **Indicadores Clave (KPIs)**
1. Energ√≠a matutina (1-10)
2. Calidad de sue√±o (1-10)
3. Nivel de estr√©s (1-10)
4. Productividad (1-10)

### **Frecuencia de Evaluaci√≥n**
- **Diario:** Check-in de 2 minutos
- **Semanal:** Revisi√≥n completa
- **Mensual:** An√°lisis profundo

## ‚ö° **ACCIONES INMEDIATAS**

1. **Hoy:** 5 respiraciones 4-7-8 cada 2 horas
2. **Ma√±ana:** Caminata de 20 minutos al despertar
3. **Esta semana:** Establecer 1 ritual matutino

---
*An√°lisis generado por algoritmo de inteligencia local ‚Ä¢ Basado en 11 dimensiones energ√©ticas*`;
        }

        // Actualizar barra de progreso
        function actualizarProgreso(porcentaje) {
            const barra = document.getElementById('barraProgreso');
            if (barra) {
                barra.style.width = porcentaje + '%';
            }
        }

        // Actualizar texto de carga
        function actualizarTextoCarga(texto) {
            const elemento = document.getElementById('textoCargando');
            if (elemento) {
                elemento.textContent = texto;
            }
        }

        // Funci√≥n principal para generar an√°lisis con IA
        async function generarAnalisisIA() {
            // Verificar consentimiento
            if (!document.getElementById('consentimientoIA').checked) {
                alert('Por favor acepta el consentimiento para usar el an√°lisis con IA.');
                return;
            }
            
            // Obtener modelo seleccionado
            const modelo = modelosIA.find(m => m.id === modeloSeleccionado);
            if (!modelo) {
                alert('Por favor selecciona un modelo de IA.');
                return;
            }
            
            // Configurar interfaz
            document.getElementById('btnAnalizarIA').style.display = 'none';
            document.getElementById('cargandoIA').style.display = 'block';
            document.getElementById('resultadoIA').style.display = 'none';
            document.getElementById('resultadoIA').innerHTML = '';
            
            // Reiniciar barra de progreso
            actualizarProgreso(0);
            
            try {
                // Actualizar texto seg√∫n modelo
                actualizarTextoCarga(`Conectando con ${modelo.nombre}...`);
                
                // Crear prompt
                const prompt = crearPromptIA();
                console.log('Prompt creado:', prompt.substring(0, 200) + '...');
                
                let respuesta;
                
                // Conectar seg√∫n el modelo seleccionado
                switch(modelo.endpoint) {
                    case 'gpt4':
                        actualizarTextoCarga('Procesando con GPT-4...');
                        respuesta = await conectarGPT4Free(prompt);
                        break;
                    case 'deepseek':
                        actualizarTextoCarga('Analizando con DeepSeek AI...');
                        respuesta = await conectarDeepSeek(prompt);
                        break;
                    case 'openrouter':
                        actualizarTextoCarga('Consultando OpenRouter...');
                        respuesta = await conectarOpenRouter(prompt);
                        break;
                    case 'local':
                        actualizarTextoCarga('Generando an√°lisis avanzado...');
                        respuesta = await analisisLocalAvanzado(prompt);
                        break;
                    default:
                        throw new Error('Modelo no v√°lido');
                }
                
                // Mostrar resultados
                mostrarResultadoIA(respuesta, modelo.nombre);
                
            } catch (error) {
                console.error('‚ùå Error en an√°lisis IA:', error);
                
                // Mostrar error
                document.getElementById('resultadoIA').innerHTML = `
                    <div style="text-align: center; padding: 30px;">
                        <div style="font-size: 3em; color: #ef4444;">‚ö†Ô∏è</div>
                        <h3 style="color: #991b1b;">Error de Conexi√≥n</h3>
                        <p style="color: #6b7280; margin: 15px 0;">
                            ${error.message}
                        </p>
                        <button onclick="generarAnalisisIA()" 
                                style="background: #3b82f6; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; margin-top: 10px;">
                            üîÑ Reintentar
                        </button>
                        <button onclick="seleccionarModelo('local_avanzado'); generarAnalisisIA()" 
                                style="background: #10b981; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; margin-top: 10px; margin-left: 10px;">
                            üñ•Ô∏è Usar an√°lisis local
                        </button>
                    </div>
                `;
                document.getElementById('resultadoIA').style.display = 'block';
                
            } finally {
                // Restaurar interfaz
                document.getElementById('cargandoIA').style.display = 'none';
                document.getElementById('btnAnalizarIA').style.display = 'flex';
            }
        }

        // Mostrar resultado de IA
        function mostrarResultadoIA(respuesta, modeloNombre) {
            // Formatear el texto manteniendo markdown
            const textoFormateado = respuesta
                .replace(/^# (.*$)/gim, '<h3 style="color: #ea4335; margin-top: 20px; border-bottom: 2px solid #fbb6b6; padding-bottom: 8px;">$1</h3>')
                .replace(/^## (.*$)/gim, '<h4 style="color: #2b6cb0; margin-top: 18px;">$1</h4>')
                .replace(/^### (.*$)/gim, '<h5 style="color: #374151; margin-top: 15px;">$1</h5>')
                .replace(/\*\*(.*?)\*\*/g, '<strong style="color: #1f2937;">$1</strong>')
                .replace(/\n\n/g, '</p><p style="margin: 10px 0; line-height: 1.6;">')
                .replace(/\n/g, '<br>')
                .replace(/^- (.*$)/gim, '<li style="margin: 8px 0; padding-left: 5px;">$1</li>')
                .replace(/^\* (.*$)/gim, '<li style="margin: 8px 0; padding-left: 5px;">$1</li>')
                .replace(/(\d+\. .*$)/gim, '<li style="margin: 8px 0; padding-left: 5px;">$1</li>');
            
            const html = `
                <div class="resultado-ia">
                    <div style="display: flex; align-items: center; gap: 12px; margin-bottom: 25px;">
                        <div style="width: 56px; height: 56px; background: linear-gradient(135deg, #667eea, #764ba2); border-radius: 12px; display: flex; align-items: center; justify-content: center;">
                            <span style="font-size: 1.8em; color: white;">ü§ñ</span>
                        </div>
                        <div>
                            <h3 style="margin: 0; color: #1f2937; font-size: 1.5em;">An√°lisis con Inteligencia Artificial</h3>
                            <div style="display: flex; gap: 10px; margin-top: 5px;">
                                <span style="background: #eff6ff; color: #3b82f6; padding: 4px 12px; border-radius: 20px; font-size: 0.85em; font-weight: 500;">
                                    ${modeloNombre}
                                </span>
                                <span style="color: #9ca3af; font-size: 0.9em;">
                                    ${new Date().toLocaleDateString('es-ES', { weekday: 'long', year: 'numeric', month: 'long', day: 'numeric' })}
                                </span>
                            </div>
                        </div>
                    </div>
                    
                    <div style="background: #f8f9fa; padding: 30px; border-radius: 12px; border: 1px solid #e5e7eb; margin-bottom: 25px;">
                        <div style="color: #374151; line-height: 1.7; font-size: 1.05em;">
                            <p style="margin: 0; line-height: 1.6;">${textoFormateado}</p>
                        </div>
                    </div>
                    
                    <div style="display: flex; gap: 12px; justify-content: center; flex-wrap: wrap; padding-top: 20px; border-top: 1px solid #e5e7eb;">
                        <button onclick="copiarAnalisisIA()" 
                                style="background: #f1f5f9; color: #475569; border: 1px solid #cbd5e1; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 0.95em; display: flex; align-items: center; gap: 8px; transition: all 0.2s;">
                            üìã Copiar an√°lisis
                        </button>
                        <button onclick="window.print()" 
                                style="background: #3b82f6; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 0.95em; display: flex; align-items: center; gap: 8px; transition: all 0.2s;">
                            üñ®Ô∏è Imprimir
                        </button>
                        <button onclick="compartirAnalisisIA()" 
                                style="background: #10b981; color: white; border: none; padding: 12px 24px; border-radius: 8px; cursor: pointer; font-size: 0.95em; display: flex; align-items: center; gap: 8px; transition: all 0.2s;">
                            üì± Compartir
                        </button>
                    </div>
                    
                    <div style="margin-top: 25px; padding: 20px; background: linear-gradient(135deg, #f0f9ff, #e0f2fe); border-radius: 10px; text-align: center; border: 2px solid #bae6fd;">
                        <small style="color: #0369a1; font-size: 0.9em;">
                            ${modeloNombre === 'An√°lisis Local Avanzado' 
                                ? '‚ú® Este an√°lisis fue generado localmente utilizando algoritmos de inteligencia avanzados.' 
                                : '‚ú® Este an√°lisis fue generado por inteligencia artificial en tiempo real. Es una herramienta complementaria.'}
                        </small>
                    </div>
                </div>
            `;
            
            document.getElementById('resultadoIA').innerHTML = html;
            document.getElementById('resultadoIA').style.display = 'block';
            
            // Scroll suave al resultado
            setTimeout(() => {
                document.getElementById('resultadoIA').scrollIntoView({ 
                    behavior: 'smooth',
                    block: 'start'
                });
            }, 300);
        }

        // Funci√≥n para copiar an√°lisis
        function copiarAnalisisIA() {
            const texto = document.querySelector('#resultadoIA p')?.innerText || 
                         document.querySelector('#resultadoIA').innerText;
            
            navigator.clipboard.writeText(texto).then(() => {
                // Mostrar notificaci√≥n
                const notificacion = document.createElement('div');
                notificacion.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: #10b981;
                    color: white;
                    padding: 12px 20px;
                    border-radius: 8px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                    z-index: 1000;
                    animation: fadeIn 0.3s;
                `;
                notificacion.innerHTML = '‚úÖ An√°lisis copiado al portapapeles';
                document.body.appendChild(notificacion);
                
                setTimeout(() => {
                    notificacion.style.animation = 'fadeOut 0.3s';
                    setTimeout(() => document.body.removeChild(notificacion), 300);
                }, 2000);
                
            }).catch(err => {
                console.error('Error al copiar:', err);
                alert('‚ùå No se pudo copiar. Intenta manualmente.');
            });
        }

        // Funci√≥n para compartir an√°lisis
        function compartirAnalisisIA() {
            if (navigator.share) {
                const { puntuacionFinal } = obtenerResultadosParaIA();
                navigator.share({
                    title: `Mi Energ√≠a Vital: ${puntuacionFinal}/10`,
                    text: 'Acabo de recibir mi an√°lisis personalizado de energ√≠a vital con IA. ¬°M√≠ralo!',
                    url: window.location.href
                });
            } else {
                copiarAnalisisIA();
                
                // Mostrar notificaci√≥n
                const notificacion = document.createElement('div');
                notificacion.style.cssText = `
                    position: fixed;
                    top: 20px;
                    right: 20px;
                    background: #3b82f6;
                    color: white;
                    padding: 12px 20px;
                    border-radius: 8px;
                    box-shadow: 0 4px 12px rgba(0,0,0,0.1);
                    z-index: 1000;
                    animation: fadeIn 0.3s;
                `;
                notificacion.innerHTML = 'üìã Enlace copiado. ¬°Comp√°rtelo donde quieras!';
                document.body.appendChild(notificacion);
                
                setTimeout(() => {
                    notificacion.style.animation = 'fadeOut 0.3s';
                    setTimeout(() => document.body.removeChild(notificacion), 300);
                }, 2000);
            }
        }

        // Mostrar secci√≥n IA
        function mostrarSeccionIA() {
            document.getElementById('seccionIA').style.display = 'block';
            setTimeout(() => {
                document.getElementById('seccionIA').scrollIntoView({ 
                    behavior: 'smooth',
                    block: 'start'
                });
            }, 300);
        }

        // Inicializaci√≥n
        console.log('üîß Diagn√≥stico de Energ√≠a Vital con IA Real');
        console.log('üöÄ Versi√≥n 4.0 - IA Integrada con Proxies Gratuitos');
        console.log('üìÖ ' + new Date().toLocaleString('es-ES'));
        
        // A√±adir estilos para animaciones
        const style = document.createElement('style');
        style.textContent = `
            @keyframes fadeIn {
                from { opacity: 0; transform: translateY(-10px); }
                to { opacity: 1; transform: translateY(0); }
            }
            @keyframes fadeOut {
                from { opacity: 1; transform: translateY(0); }
                to { opacity: 0; transform: translateY(-10px); }
            }
        `;
        document.head.appendChild(style);
    </script>
</body>
</html>
